<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Tela de Cadastro </title>

    <script src="./js/funcoes.js"></script>



    <link rel="stylesheet" href="css/cadastro.css">
</head>
<body>
    
     <header class="header">
         <div class="logo"> </div>
         <div class="navbar">
             <a class="item" href="index.html"> Menu </a>
             <a class="item" href=""> Quem Somos </a>
             <a class="item" href="cadastro.html"> Cadastro </a>
             <a class="item" href="login.html"> Login </a>
         </div>
         
     </header>

     <div class="titulo">
        <p class="item-escrito">A criatividade é pensar coisas novas. A inovação é fazer coisas novas.</p>
         <h1 class="item-escrito2"> Cadastre-se </h1>
     </div>
     <section class="sessao">
         <div class="pre-form">
             <form class="form" id="form_cadastro" method="post" onsubmit="return cadastrar()">
                <p> Instituição </p>
                <label class="label-input">
                    <input type="text" name="instituicao" placeholder="ex.Escola de direito" data-required>
               </label>
               <p> Rua </p>
               <label class="label-input">
                    <input type="text" name="rua" placeholder="ex.Av.Paulista" data-required>
               </label>
               <p> Número </p>
               <label class="label-input">
                     <input type="number" name="numero" placeholder="ex.1000" data-required>
               </label>
               <p> Bairro </p>
               <label class="label-input">
                    <input type="text" name="bairro" placeholder="ex.Jardim Morumbi" data-required>
               </label>
               <p> Estado </p>
               <label class="label-input">
                    <input type="text" name="estado" placeholder="ex. Bahia" data-required>
               </label>
               <p> cidade </p>
               <label class="label-input">
                    <input type="text" name="cidade" placeholder="ex. Salvador" data-required>
               </label>
               <p> CEP </p>
               <label class="label-input">
                    <input type="number" name="cep" placeholder="ex.00000-000" data-required>
               </label>
               <p> Complemento </p>
               <label class="label-input">
                    <input type="text" name="complemento" placeholder="ex.Trabalho" data-required>
               </label>
               <p> Ponto de Referência </p>
               <label class="label-input">
                     <input type="text" name="ponto" placeholder="ex.Mercado do Jão" data-required>
               </label>
               <p> Email </p>
               <label class="label-input">
                    <input type="email" name="email" placeholder="ex.control@tec.com.br" data-required   data-email-validate>
               </label>
               <p> Senha </p>
               <label class="label-input">
                    <input type="password" name="senha" placeholder="ex.********" data-required  data-senha-validate>
               </label> 
               <p> Confirmar Senha </p>
               <label class="label-input">
                    <input type="password" name="confirmarsenha" placeholder="ex.********" data-required  data-confirmarsenha-validate>
               </label> 
                <button class="btn"> Cadastre-se </button>
             </form>
            </div>
         </div>
     </section>

     <footer class="footer">
         <div class="logo">
          <p> Logo </p>
         </div>
         <div class="dados">
           <p> <h5> Início </h5>
               Menu <br>
               Quem Somos <br>  
            </p>
         </div>
         <div class="dados2">
             <p>
              <h5> Suporte </h5>
              FAQ <br>
              Telefones <br>
              Chat <br>
            </p>
         </div>
         <div class="media">
           <p> @2022 Copyright - Control Tec </p>
         </div>
     </footer>


</body>
</html>
<script>

     function limparFormulario() {
         document.getElementById("form").reset();
     }
 
     function cadastrar() {
          aguardar();
 
         var formulario = new URLSearchParams(new FormData(document.getElementById("form")));
 
         var instituicao = formulario.get("instituicao");
         var rua = formulario.get("rua");
         var numero = formulario.get("numero");
         var bairro = formulario.get("bairro");
         var estado = formulario.get("estado");
         var cidade = formulario.get("cidade");
         var cep = formulario.get("cep");
         var email = formulario.get("email");
         var criar = formulario.get("senha");
         var confirmar = formulario.get("confirmarsenha");
 
         // TODO: VERIFICAR AS VALIDAÇÕES QUE ELES ESTÃO APRENDENDO EM ALGORITMOS 
         if (instituicao == "" || rua == "" || numero == ""|| bairro =="" || estado == "" || cidade == "" || cep == "" || email == "" || criar == "" ||  confirmar == "") {
             
             window.alert("Preencha todos os campos para prosseguir!");
             if (instituicao == "")  {
                 console.log('Instituição está em branco')
             }
             if (rua == "")  {
                 console.log('Rua está em branco')
             }
             if (numero == "")  {
                 console.log('Número está em branco')
             }
             if (bairro == "")  {
                 console.log('Bairro está em branco')
             }
             if (estado == "")  {
                 console.log('Estado está em branco')
             }
             if (cidade == "")  {
                 console.log('Cidade está em branco')
             }
             if (cep == "")  {
                 console.log(' Cep está em branco')
             }
             if (email == "" )  {
                 console.log('Email está em branco')
             }
             if (criar != confirmar )  {
                 console.log('As senhas não conferem')
             }
             finalizarAguardar();
             return false;
         }
         
         if (email.indexOf("@") == -1 || email.indexOf(".com") == -1) {
             window.alert("Ops, e-mail inválido! Verifique e tente novamente.");
             finalizarAguardar();
             return false;
         }
         
         if (criar != confirmar) {
             window.alert("As senhas inseridas devem ser iguais para prosseguir!");
             finalizarAguardar();
             return false;
         }
 
         fetch("/usuarios/cadastrar", {
             method: "POST",
             body: formulario
         }).then(function (resposta) {
 
             console.log("resposta: ", resposta);
 
             if (resposta.ok) {
                 window.alert("Cadastro realizado com sucesso!");
                 window.location = "login.html";
                 limparFormulario();
                 finalizarAguardar();
             } else {
                 throw("Houve um erro ao tentar realizar o cadastro!");
             }
         }).catch(function (resposta) {
             console.log(`#ERRO: ${resposta}`);
             finalizarAguardar();
         });
 
         return false;
     }
 
 </script>
 